# Android天气预报应用编译说明

## 环境要求

### 1. JDK
- **版本**: JDK 17 或更高版本
- **检查方法**: 
  ```bash
  java -version
  ```
- **下载**: https://www.oracle.com/java/technologies/downloads/

### 2. Android SDK
- **版本**: Android SDK Platform 34 (Android 14)
- **必需组件**:
  - Android SDK Build-Tools 34.0.0
  - Android SDK Platform-Tools
  - Android SDK Command-line Tools
- **设置环境变量**:
  ```bash
  export ANDROID_HOME=/path/to/Android/Sdk
  export PATH=$PATH:$ANDROID_HOME/tools
  export PATH=$PATH:$ANDROID_HOME/platform-tools
  ```

### 3. Android NDK (可选)
- 如果项目包含原生代码，需要安装NDK
- 版本: 最新稳定版即可

### 4. Gradle
- **版本**: 8.2 或更高版本
- 项目已包含Gradle Wrapper，会自动下载对应版本
- 手动安装: https://gradle.org/install/

## 编译步骤

### 方法1: 使用Gradle Wrapper (推荐)

```bash
# 进入项目目录
cd /home/you/cursor/weather

# 赋予执行权限
chmod +x gradlew

# 清理项目
./gradlew clean

# 编译Debug版本
./gradlew assembleDebug

# 编译Release版本
./gradlew assembleRelease
```

生成的APK文件位置:
- Debug: `app/build/outputs/apk/debug/app-debug.apk`
- Release: `app/build/outputs/apk/release/app-release.apk`

### 方法2: 使用构建脚本

```bash
# 赋予执行权限
chmod +x build.sh

# 运行构建脚本
./build.sh
```

### 方法3: 使用Android Studio

1. 打开Android Studio
2. 选择 `File` -> `Open`
3. 选择项目目录 `/home/you/cursor/weather`
4. 等待Gradle同步完成
5. 点击 `Build` -> `Build Bundle(s) / APK(s)` -> `Build APK(s)`
6. 或者直接运行: `Run` -> `Run 'app'`

## 配置local.properties

如果使用命令行编译，需要创建 `local.properties` 文件:

```bash
# 复制示例文件
cp local.properties.example local.properties

# 编辑文件，设置Android SDK路径
# sdk.dir=/path/to/your/Android/Sdk
```

## 签名配置 (Release版本)

Release版本需要签名才能安装。创建签名密钥:

```bash
keytool -genkey -v -keystore weather-release-key.jks \
  -keyalg RSA -keysize 2048 -validity 10000 \
  -alias weather-key
```

然后在 `app/build.gradle` 中添加签名配置:

```gradle
android {
    ...
    signingConfigs {
        release {
            storeFile file('weather-release-key.jks')
            storePassword 'your-store-password'
            keyAlias 'weather-key'
            keyPassword 'your-key-password'
        }
    }
    buildTypes {
        release {
            signingConfig signingConfigs.release
            ...
        }
    }
}
```

## 常见问题

### 1. Gradle同步失败
- 检查网络连接
- 检查 `build.gradle` 中的仓库配置
- 尝试清理缓存: `./gradlew clean --refresh-dependencies`

### 2. SDK路径未找到
- 设置 `ANDROID_HOME` 环境变量
- 创建 `local.properties` 文件并配置 `sdk.dir`

### 3. 编译错误: 找不到符号
- 确保所有依赖都已下载
- 运行 `./gradlew clean build`

### 4. 网络请求失败
- 检查设备网络连接
- 确认API Key有效
- 检查AndroidManifest.xml中的网络权限

## 安装APK

### 使用adb安装

```bash
# 连接设备
adb devices

# 安装Debug版本
adb install app/build/outputs/apk/debug/app-debug.apk

# 安装Release版本
adb install app/build/outputs/apk/release/app-release.apk
```

### 直接安装
将APK文件传输到Android设备，点击安装即可。

## Android 14兼容性

应用已配置为兼容Android 14:
- `compileSdkVersion`: 34
- `targetSdkVersion`: 34
- `minSdkVersion`: 24 (Android 7.0)

确保设备系统版本为Android 7.0或更高版本。
